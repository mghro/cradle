sudo: false
dist: trusty

language: python
python:
  - 3.6

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-5
      - gcc-5
      - lcov
      - cmake
      - git
      - curl
      - libc6-dev
      - binutils-dev

before_script:
  - export XDG_CACHE_HOME=$TRAVIS_BUILD_DIR/cache
  - python --version
  - pip install conan jinja2 gcovr pytest websocket-client
  - export CC=`which gcc-5`
  - export CXX=`which g++-5`
  - export CONAN_USER_HOME=`pwd`/conan-cache
  - conan remote add bincrafters https://api.bintray.com/conan/bincrafters/public-conan
  - conan remote add conan-community https://api.bintray.com/conan/conan-community/conan
  - ./fips set config linux-make-debug
  - ./fips gen

script:
  - python python/generate_config.py $CRADLE_THINKNODE_API_TOKEN
  - ./fips make unit_test_coverage
  - ./fips make integration_tests
